/*! For license information please see bundle.js.LICENSE.txt */
(()=>{"use strict";var t={};function e(t,e){if(0!==t[3]){var n=(1,r=t[3]-136,1*Math.pow(2,r));e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n}else e[0]=e[1]=e[2]=0;var r}function n(t,e){var n=t[0],r=t[1],i=t[2],o=Math.max(n,Math.max(r,i));if(o<1e-32)e[0]=e[1]=e[2]=e[3]=0;else{var a=function(t){var e={f:t=Number(t),e:0};if(0!==t&&Number.isFinite(t)){for(var n=Math.abs(t),r=Math.log2||function(t){return Math.log(t)*Math.LOG2E},i=Math.max(-1023,Math.floor(r(n))+1),o=n*Math.pow(2,-i);o>=1;)o*=.5,i++;for(;o<.5;)o*=2,i--;t<0&&(o=-o),e.f=o,e.e=i}return e}(o),s=a.f,u=a.e,c=s/o*256;e[0]=n*c,e[1]=r*c,e[2]=i*c,e[3]=u+128}}function r(t,e,n){var r=[];return function(t,e,n,r,o){if(!(n<=0||e<=0)&&o){("#?RADIANCE\n# Written by hdr.js\nFORMAT=32-bit_rle_rgbe\nEXPOSURE=1.0\n\n-Y "+n+" +X "+e+"\n").split("").forEach((function(e){var n=e.charCodeAt(0);t.push(n)}));for(var a=new Uint8Array(4*e),s=0;s<n;s++)i(t,e,3,a,o.subarray(3*e*s))}}(r,t,e,0,n),new Uint8Array(r)}function i(t,e,r,i,s){var u,c=new Uint8Array([2,2,0,0]),l=new Uint8Array(4),f=new Float32Array(3);if(c[2]=(65280&e)>>8,c[3]=255&e,e<8||e>=32768)for(u=0;u<e;u++){switch(r){case 4:case 3:f[2]=s[u*r+2],f[1]=s[u*r+1],f[0]=s[u*r+0];break;default:f[0]=f[1]=f[2]=s[u*r+0]}n(f,l),t.push(l[0],l[1],l[2],l[3])}else{var E=void 0,h=void 0;for(u=0;u<e;u++){switch(r){case 4:case 3:f[2]=s[u*r+2],f[1]=s[u*r+1],f[0]=s[u*r+0];break;default:f[0]=f[1]=f[2]=s[u*r+0]}n(f,l),i[u+0*e]=l[0],i[u+1*e]=l[1],i[u+2*e]=l[2],i[u+3*e]=l[3]}for(t.push(c[0],c[1],c[2],c[3]),E=0;E<4;E++){var p=i.subarray(e*E);for(u=0;u<e;){for(h=u;h+2<e&&(p[h]!==p[h+1]||p[h]!==p[h+2]);)++h;for(h+2>=e&&(h=e);u<h;)(m=h-u)>128&&(m=128),o(t,m,p.subarray(u)),u+=m;if(h+2<e){for(;h<e&&p[h]==p[u];)++h;for(;u<h;){var m;(m=h-u)>127&&(m=127),a(t,m,p[u]),u+=m}}}}}}function o(t,e,n){var r=255&e;if(!(e<=128))throw new Error("length is greater than 128");t.push(r);for(var i=0;i<e;i++)t.push(n[i])}function a(t,e,n){var r=e+128&255;if(!(e+128<=255))throw new Error("length is greater than 128");t.push(r,n)}function s(t,e){for(var n=e.length,r=0;r<n;r++)if(t[r]!==e.charCodeAt(r))return!1;return!0}t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var n=t.g.document;if(!e&&n&&(n.currentScript&&(e=n.currentScript.src),!e)){var r=n.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();var u=1<<24;function c(t){var n="",r=0;if(!function(t){var e=s(t,"#?RADIANCE\n");return e||(e=s(t,"#?RGBE\n")),e}(t))return"Corrupt HDR image.";for(;!n.match(/\n\n[^\n]+\n/g)&&r<10240;)n+=String.fromCharCode(t[r++]);var i=n.match(/FORMAT=(.*)$/m)[1];if("32-bit_rle_rgbe"!==i)return"Unsupported HDR format: "+i;var o=n.split(/\n/).reverse()[1].split(" ");if("-Y"!==o[0]||"+X"!==o[2])return"Unsupported HDR format";var a,c,l=Number.parseFloat(o[3]),f=Number.parseFloat(o[1]);if(l>u||f>u)return"Very large image (corrupt?)";var E=t[r],h=t[r+1],p=t[r+2],m=2!==E||2!==h||!!(128&p),d=new Float32Array(l*f*3);if(l<8||l>=32768||m)for(c=0;c<f;++c)for(a=0;a<l;++a){var _=t.subarray(r,r+4);r+=4;var x=3*(c*l+a);e(_,d.subarray(x,x+3))}else for(var y,T,g,A=void 0,w=0;w<f;w++){if(y=t[r++],T=t[r++],g=t[r++],2!==y||2!==T||128&g)return"Invalid scanline";if(g<<=8,(g|=t[r++])!==l)return"invalid decoded scanline length";A||(A=new Uint8Array(4*l));for(var R=void 0,v=void 0,b=0;b<4;b++){var S=void 0;for(a=0;(S=l-a)>0;)if((R=t[r++])>128){if(v=t[r++],(R-=128)>S)return"bad RLE data in HDR";for(var C=0;C<R;C++)A[4*a+++b]=v}else{if(R>S)return"bad RLE data in HDR";for(C=0;C<R;C++)A[4*a+++b]=t[r++]}}for(var M=0;M<l;M++)e(A.subarray(4*M),d.subarray(3*(w*l+M)))}return{rgbFloat:d,width:l,height:f}}var l=Object.freeze({load:function(t){return new Promise((function(e,n){"undefined"==typeof XMLHttpRequest&&n("XMLHttpRequest is undefined, use HDRjs.read instead.");var r=new XMLHttpRequest;r.responseType="arraybuffer",r.onload=function(){if(r.status>=400)return n("Load successfully, but HTTP status code >= 400, status: "+r.status);var t=c(new Uint8Array(r.response));"string"==typeof t?n(t):e(t)},r.onerror=function(e){n("Failed to load: "+t)},r.open("GET",t,!0),r.send()}))},save:function(t,e,n,i){if(!(null===document||void 0===document?void 0:document.createElement)||!(null===URL||void 0===URL?void 0:URL.createObjectURL))return console.warn("NO document.createElement or URL.createObjectURL"),!1;var o=r(e,n,t),a=URL.createObjectURL(new Blob([o])),s=document.createElement("a");return s.href=a,s.download=i+".hdr",s.rel="noopener",setTimeout((function(){URL.revokeObjectURL(s.href)}),4e4),setTimeout((function(){!function(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}(s)}),0),!0},read:c,write:r,float2rgbe:n,rgbe2float:e});function f(t,e){return null==t?e:t}f.EMPTY_OBJECT=Object.freeze({});const E=window;function h(t){return null!=t}function p(t){return!("KEEP"!==(t=t.toUpperCase())&&"ZERO"!==t&&"REPLACE"!==t&&"INCR"!==t&&"DECR"!==t&&"INVERT"!==t&&"INCR_WRAP"!==t&&"DECR_WRAP"!==t)}function m(t,e){const n=t[e];if(!h(n))throw new Error("gl."+e+" is not defined.");return n}function d(t,e,n){if(h(n.writeMask)&&t.stencilMaskSeparate(e,n.writeMask),h(n.func)&&h(n.ref)&&h(n.valueMask)){if(!1===function(t){return!("NEVER"!==(t=t.toUpperCase())&&"ALWAYS"!==t&&"LESS"!==t&&"LEQUAL"!==t&&"NOTEQUAL"!==t&&"EQUAL"!==t&&"GREATER"!==t&&"GEQUAL"!==t)}(n.func))throw new Error("setState: stencil func is invalid, current is "+n.func+"!");const r=n.func.toUpperCase();t.stencilFuncSeparate(e,t[r],n.ref,n.valueMask)}if(h(n.fail)&&h(n.zfail)&&h(n.zpass)){if(!1===p(n.fail)||!1===p(n.zfail)||!1===p(n.zpass))throw new Error("setState: stencil op is invalid, current is "+n.fail+", "+n.zfail+", "+n.zpass+"!");const r=n.fail.toUpperCase(),i=n.zfail.toUpperCase(),o=n.zpass.toUpperCase();t.stencilOpSeparate(e,t[r],t[i],t[o])}}const _=5121,x=5123,y=5125;function T(t){return 0==(t&t-1)}function g(t,e){const{internalFormat:n,type:r,format:i,width:o,height:a,data:s,generateMipmap:u}=e,c=f(e.depth,1),l=f(e.wrapS,t.CLAMP_TO_EDGE),E=f(e.wrapT,t.CLAMP_TO_EDGE),h=f(e.wrapR,t.CLAMP_TO_EDGE),p=f(e.minFilter,t.LINEAR),m=f(e.magFilter,t.LINEAR);let d=e.levels;d||(d=[s]);const _=f(e.flipY,!1),x=f(e.premultiplyAlpha,!1);t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,_),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,x);const y=t.createTexture(),g=f(e.target,t.TEXTURE_2D);t.activeTexture(t.TEXTURE0),t.bindTexture(g,y),r===t.FLOAT&&(t instanceof WebGLRenderingContext&&!t._textureFloat&&console.warn("Do not support float texture."),p!==t.LINEAR&&p!==t.LINEAR_MIPMAP_NEAREST&&p!==t.NEAREST_MIPMAP_LINEAR&&p!==t.LINEAR_MIPMAP_LINEAR||t._textureFloatLinear||console.warn("Do not support float texture linear filter."));const A=d.length;for(let e=0;e<A;e++){const s=d[e];if(s instanceof HTMLImageElement||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement)g===t.TEXTURE_2D?t.texImage2D(t.TEXTURE_2D,e,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,s):t.TEXTURE_3D;else{const u=0;g===t.TEXTURE_2D?t.texImage2D(t.TEXTURE_2D,e,n,o,a,u,i,r,s):g===t.TEXTURE_3D&&(t.texImage3D(t.TEXTURE_3D,e,n,o,a,c,u,i,r,s),t.texParameteri(g,t.TEXTURE_WRAP_R,h))}}return t.texParameteri(g,t.TEXTURE_WRAP_S,l),t.texParameteri(g,t.TEXTURE_WRAP_T,E),t.texParameteri(g,t.TEXTURE_MIN_FILTER,p),t.texParameteri(g,t.TEXTURE_MAG_FILTER,m),!0===u&&(T(o)&&T(a)||t instanceof WebGL2RenderingContext?t.generateMipmap(g):console.warn("createTexture: texture size is NOT power of two, current is "+o+"x"+a+".")),t.bindTexture(g,null),y}const A={};function w(t){let e,n=t[0];for(let e=1;e<t.length;e++)n=Math.max(n,t[e]);return e=n<=255?_:n<=65535?x:y,e}function R(t,e,n,r){const i=t.createBuffer();return t.bindBuffer(e,i),t.bufferData(e,n,r),t.bindBuffer(e,null),i}function v(t,e,n){let r="";for(const t of e){if(r.length>1e6)break;r+=`${t.toFixed(3)},`}let i,o=A[r];if(o)return o;if(n=f(n,t.STATIC_DRAW),Array.isArray(e))i=new Float32Array(e);else{if(!((a=e)instanceof Float32Array||a instanceof Uint8Array||a instanceof Uint16Array||a instanceof Uint32Array||a instanceof Int8Array||a instanceof Int16Array||a instanceof Int32Array))throw new Error("Buffer data"+e+"must be TypedArray or Array ");i=e}var a;return o=R(t,t.ARRAY_BUFFER,i,n),A[r]=o,o}function b(t,e,n){const r=e.toString();let i,o=A[r];if(o)return o;n=f(n,t.STATIC_DRAW);const a=w(e);if(a===t.UNSIGNED_BYTE)i=new Uint8Array(e);else if(a===t.UNSIGNED_SHORT)i=new Uint16Array(e);else{if(a!==t.UNSIGNED_INT)throw new Error("Buffer data must be TypedArray or Array ");i=new Uint32Array(e),t.getExtension("OES_element_index_unit")}return o=R(t,t.ELEMENT_ARRAY_BUFFER,i,n),o.indicesType=a,A[r]=o,o}function S(t,e){if(!t.createVertexArray)return;const n=t.getParameter(t.VERTEX_ARRAY_BINDING),r=t.createVertexArray();t.bindVertexArray(r);const i=e.attributes,o=e.indices;for(const e in i)if(Object.hasOwnProperty.call(i,e)){const{location:n,data:r,size:o,divisor:a}=i[e],s=v(t,r,t.STATIC_DRAW);t.bindBuffer(t.ARRAY_BUFFER,s),t.enableVertexAttribArray(n);const u=t.FLOAT,c=!1,l=0,f=0;t.vertexAttribPointer(n,o,u,c,l,f),h(a)&&t.vertexAttribDivisor(n,a)}if(h(o)){const e=b(t,o,t.STATIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e)}return t.bindVertexArray(n),r}const C={},M={};function z(t){let e=0;switch(t){case 5126:e=1;break;case 35664:e=2;break;case 35665:e=3;break;case 35666:case 35674:e=4;break;case 35675:e=9;break;case 35676:e=16;break;default:throw new Error("Unrecognize "+t+" type.")}return e}function F(t){const{name:e,size:n,type:r}=t;return n*z(r)}const I={};function P(t,e,n){this.phi=f(t,0),this.theta=f(e,0),this.radius=f(n,1)}P.fromCartesian3=function(t,e){h(e)||(e=new P);const n=t.x,r=t.y,i=t.z,o=n*n+r*r;return e.phi=Math.atan2(r,n),e.theta=Math.atan2(Math.sqrt(o),i),e.radius=Math.sqrt(o+i*i),e},P.clone=function(t,e){if(h(t))return h(e)?(e.phi=t.phi,e.theta=t.theta,e.radius=t.radius,e):new P(t.phi,t.theta,t.radius)},P.normalize=function(t,e){return h(e)?(e.phi=t.phi,e.theta=t.theta,e.radius=1,e):new P(t.phi,t.theta,1)},P.equals=function(t,e){return t===e||h(t)&&h(e)&&t.phi===e.phi&&t.theta===e.theta&&t.radius===e.radius},P.equalsEpsilon=function(t,e,n){return n=f(n,0),t===e||h(t)&&h(e)&&Math.abs(t.phi-e.phi)<=n&&Math.abs(t.theta-e.theta)<=n&&Math.abs(t.radius-e.radius)<=n},P.prototype.toString=function(){return`(${this.phi}, ${this.theta}, ${this.radius})`};const N={};function L(t,e){this.x=f(t,0),this.y=f(e,0)}function O(t,e,n){this.x=f(t,0),this.y=f(e,0),this.z=f(n,0)}N.EPSILON1=.1,N.EPSILON2=.01,N.EPSILON3=.001,N.EPSILON4=1e-4,N.EPSILON5=1e-5,N.EPSILON6=1e-6,N.EPSILON7=1e-7,N.EPSILON8=1e-8,N.EPSILON9=1e-9,N.EPSILON10=1e-10,N.EPSILON11=1e-11,N.EPSILON12=1e-12,N.EPSILON13=1e-13,N.EPSILON14=1e-14,N.EPSILON15=1e-15,N.equalsEpsilon=function(t,e,n,r){n=f(n,0),r=f(r,n);const i=Math.abs(t-e);return i<=r||i<=n*Math.max(Math.abs(t),Math.abs(e))},N.toRadians=function(t){return t/180*Math.PI},N.toDegrees=function(t){return t/Math.PI*180},N.clamp=function(t,e,n){return Math.max(e,Math.min(n,t))},N.lerp=function(t,e,n){return(1-n)*t+n*e},Object.defineProperties(L.prototype,{length:{get:function(){return 2}},0:{get:function(){return this.x}},1:{get:function(){return this.y}}}),L.fromElements=function(t,e,n){return h(n)?(n.x=t,n.y=e,n):new L(t,e)},L.clone=function(t,e){if(h(t))return h(e)?(e.x=t.x,e.y=t.y,e):new L(t.x,t.y)},L.equals=function(t,e){return t===e||h(t)&&h(e)&&t.x===e.x&&t.y===e.y},L.fromCartesian3=L.clone,L.fromCartesian4=L.clone,L.clamp=function(t,e,n,r){const i=N.clamp(t.x,e.x,n.x),o=N.clamp(t.y,e.y,n.y);return r.x=i,r.y=o,r},L.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y},L.ZERO=Object.freeze(new L(0,0,0)),L.magnitude=function(t){return Math.sqrt(L.magnitudeSquared(t))},L.normalize=function(t,e){const n=L.magnitude(t);if(e.x=t.x/n,e.y=t.y/n,isNaN(e.x)||isNaN(e.y))throw new Error("normalized result is not a number");return e},L.dot=function(t,e){return t.x*e.x+t.y*e.y},L.cross=function(t,e){return t.x*e.y-t.y*e.x},L.add=function(t,e,n){return n.x=t.x+e.x,n.y=t.y+e.y,n},L.subtract=function(t,e,n){return n.x=t.x-e.x,n.y=t.y-e.y,n},L.multiplyByScalar=function(t,e,n){return n.x=t.x*e,n.y=t.y*e,n},L.divideByScalar=function(t,e,n){return n.x=t.x/e,n.y=t.y/e,n},L.negate=function(t,e){return e.x=-t.x,e.y=-t.y,e},L.ONE=Object.freeze(new L(1,1)),L.UNIT_X=Object.freeze(new L(1,0)),L.UNIT_Y=Object.freeze(new L(0,1)),L.prototype.clone=function(t){return L.clone(this,t)},L.prototype.normalize=function(){return L.normalize(this,this)},L.prototype.toString=function(){return`(${this.x}, ${this.y})`},Object.defineProperties(O.prototype,{length:{get:function(){return 3}},0:{get:function(){return this.x}},1:{get:function(){return this.y}},2:{get:function(){return this.z}}}),O.fromElements=function(t,e,n,r){return h(r)?(r.x=t,r.y=e,r.z=n,r):new O(t,e,n)},O.fromSpherical=function(t,e){h(e)||(e=new O);const n=t.phi,r=t.theta,i=f(t.radius,1),o=Math.sin(r);return e.x=Math.cos(n)*o*i,e.y=Math.sin(n)*o*i,e.z=Math.cos(r)*i,e},O.clone=function(t,e){if(h(t))return h(e)?(e.x=t.x,e.y=t.y,e.z=t.z,e):new O(t.x,t.y,t.z)},O.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y+t.z*t.z},O.magnitude=function(t){return Math.sqrt(O.magnitudeSquared(t))};const U=new O;O.distance=function(t,e){return O.subtract(t,e,U),O.magnitude(U)},O.normalize=function(t,e){const n=O.magnitude(t);if(e.x=t.x/n,e.y=t.y/n,e.z=t.z/n,isNaN(e.x)||isNaN(e.y)||isNaN(e.z))throw new Error("normalized result is not a number");return e},O.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},O.multiplyComponents=function(t,e,n){return n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n},O.divideComponents=function(t,e,n){return n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n},O.add=function(t,e,n){return n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n},O.subtract=function(t,e,n){return n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n},O.multiplyByScalar=function(t,e,n){return n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n},O.divideByScalar=function(t,e,n){return n.x=t.x/e,n.y=t.y/e,n.z=t.z/e,n},O.negate=function(t,e){return e.x=-t.x,e.y=-t.y,e.z=-t.z,e};const D=new O,B=new O;function G(t,e,n,r){this.x=f(t,0),this.y=f(e,0),this.z=f(n,0),this.w=f(r,0)}O.clamp=function(t,e,n,r){"number"==typeof e&&(e=O.fromElements(e,e,e,D)),"number"==typeof n&&(n=O.fromElements(n,n,n,B));const i=N.clamp(t.x,e.x,n.x),o=N.clamp(t.y,e.y,n.y),a=N.clamp(t.z,e.z,n.z);return r.x=i,r.y=o,r.z=a,r},O.equals=function(t,e){return t===e||h(t)&&h(e)&&t.x===e.x&&t.y===e.y&&t.z===e.z},O.equalsEpsilon=function(t,e,n,r){return t===e||h(t)&&h(e)&&N.equalsEpsilon(t.x,e.x,n,r)&&N.equalsEpsilon(t.y,e.y,n,r)&&N.equalsEpsilon(t.z,e.z,n,r)},O.cross=function(t,e,n){const r=t.x,i=t.y,o=t.z,a=e.x,s=e.y,u=e.z,c=i*u-o*s,l=o*a-r*u,f=r*s-i*a;return n.x=c,n.y=l,n.z=f,n},O.pack=function(t,e,n){return n=f(n,0),e[n++]=t.x,e[n++]=t.y,e[n]=t.z,e},O.ZERO=Object.freeze(new O(0,0,0)),O.ONE=Object.freeze(new O(1,1,1)),O.UNIT_X=Object.freeze(new O(1,0,0)),O.UNIT_Y=Object.freeze(new O(0,1,0)),O.UNIT_Z=Object.freeze(new O(0,0,1)),O.prototype.clone=function(t){return O.clone(this,t)},O.prototype.normalize=function(){return O.normalize(this,this)},O.prototype.clamp=function(t,e){return O.clamp(this,t,e,this)},O.prototype.equals=function(t){return O.equals(this,t)},O.prototype.equalsEpsilon=function(t,e,n){return O.equalsEpsilon(this,t,e,n)},O.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z})`},Object.defineProperties(G.prototype,{length:{get:function(){return 4}},0:{get:function(){return this.x}},1:{get:function(){return this.y}},2:{get:function(){return this.z}},3:{get:function(){return this.w}}}),G.clone=function(t,e){if(h(t))return h(e)?(e.x=t.x,e.y=t.y,e.z=t.z,e.w=t.w,e):new G(t.x,t.y,t.z,t.w)},G.magnitudeSquared=function(t){return t.x*t.x+t.y*t.y+t.z*t.z+t.w*t.w},G.magnitude=function(t){return Math.sqrt(G.magnitudeSquared(t))};const X=new G;function V(t,e,n,r,i,o,a,s,u){this[0]=f(t,0),this[1]=f(r,0),this[2]=f(a,0),this[3]=f(e,0),this[4]=f(i,0),this[5]=f(s,0),this[6]=f(n,0),this[7]=f(o,0),this[8]=f(u,0)}G.distance=function(t,e){return G.subtract(t,e,X),G.magnitude(X)},G.normalize=function(t,e){const n=G.magnitude(t);if(e.x=t.x/n,e.y=t.y/n,e.z=t.z/n,e.w=t.w/n,isNaN(e.x)||isNaN(e.y)||isNaN(e.z)||isNaN(e.w))throw new Error("normalized result is not a number");return e},G.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z+t.w*e.w},G.multiplyComponents=function(t,e,n){return n.x=t.x*e.x,n.y=t.y*e.y,n.z=t.z*e.z,n.w=t.w*e.w,n},G.divideComponents=function(t,e,n){return n.x=t.x/e.x,n.y=t.y/e.y,n.z=t.z/e.z,n.w=t.w/e.w,n},G.add=function(t,e,n){return n.x=t.x+e.x,n.y=t.y+e.y,n.z=t.z+e.z,n.w=t.w+e.w,n},G.subtract=function(t,e,n){return n.x=t.x-e.x,n.y=t.y-e.y,n.z=t.z-e.z,n.w=t.w-e.w,n},G.multiplyByScalar=function(t,e,n){return n.x=t.x*e,n.y=t.y*e,n.z=t.z*e,n.w=t.w*e,n},G.divideByScalar=function(t,e,n){return n.x=t.x/e,n.y=t.y/e,n.z=t.z/e,n.w=t.w/e,n},G.negate=function(t,e){return e.x=-t.x,e.y=-t.y,e.z=-t.z,e.w=-t.w,e},G.equals=function(t,e){return t===e||h(t)&&h(e)&&t.x===e.x&&t.y===e.y&&t.z===e.z&&t.w===e.w},G.equalsEpsilon=function(t,e,n,r){return t===e||h(t)&&h(e)&&N.equalsEpsilon(t.x,e.x,n,r)&&N.equalsEpsilon(t.y,e.y,n,r)&&N.equalsEpsilon(t.z,e.z,n,r)&&N.equalsEpsilon(t.w,e.w,n,r)},G.pack=function(t,e,n){return n=f(n,0),e[n++]=t.x,e[n++]=t.y,e[n++]=t.z,e[n]=t.w,e},G.packArray=function(t,e){const n=t.length,r=4*n;if(h(e)){if(!Array.isArray(e)&&e.length!==r)throw new Error("If result is a typed array, it must have exactly array.length * 4 elements");e.length!==r&&(e.length=r)}else e=new Array(r);for(let r=0;r<n;++r)G.pack(t[r],e,4*r);return e},G.prototype.clone=function(t){return G.clone(this,t)},G.prototype.normalize=function(){return G.normalize(this,this)},G.prototype.equals=function(t){return G.equals(this,t)},G.prototype.equalsEpsilon=function(t,e,n){return G.equalsEpsilon(this,t,e,n)},G.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`},Object.defineProperties(V.prototype,{length:{get:function(){return 9}}}),V.clone=function(t,e){if(h(t))return h(e)?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e):new V(t[0],t[3],t[6],t[1],t[4],t[7],t[2],t[5],t[8])},V.fromColumnMajorArray=function(t,e){return V.clone(t,e)},V.fromRowMajorArray=function(t,e){return h(e)?(e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],e):new V(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},V.fromQuaternion=function(t,e){const n=t.x*t.x,r=t.x*t.y,i=t.x*t.z,o=t.x*t.w,a=t.y*t.y,s=t.y*t.z,u=t.y*t.w,c=t.z*t.z,l=t.z*t.w,f=t.w*t.w,E=n-a-c+f,p=2*(r-l),m=2*(i+u),d=2*(r+l),_=-n+a-c+f,x=2*(s-o),y=2*(i-u),T=2*(s+o),g=-n-a+c+f;return h(e)?(e[0]=E,e[1]=d,e[2]=y,e[3]=p,e[4]=_,e[5]=T,e[6]=m,e[7]=x,e[8]=g,e):new V(E,p,m,d,_,x,y,T,g)},V.fromHeadingPitchRoll=function(t,e){const n=Math.cos(-t.pitch),r=Math.cos(-t.heading),i=Math.cos(t.roll),o=Math.sin(-t.pitch),a=Math.sin(-t.heading),s=Math.sin(t.roll),u=n*r,c=-i*a+s*o*r,l=s*a+i*o*r,f=n*a,E=i*r+s*o*a,p=-s*r+i*o*a,m=-o,d=s*n,_=i*n;return h(e)?(e[0]=u,e[1]=f,e[2]=m,e[3]=c,e[4]=E,e[5]=d,e[6]=l,e[7]=p,e[8]=_,e):new V(u,c,l,f,E,p,m,d,_)},V.fromScale=function(t,e){return h(e)?(e[0]=t.x,e[1]=0,e[2]=0,e[3]=0,e[4]=t.y,e[5]=0,e[6]=0,e[7]=0,e[8]=t.z,e):new V(t.x,0,0,0,t.y,0,0,0,t.z)},V.fromUniformScale=function(t,e){return h(e)?(e[0]=t,e[1]=0,e[2]=0,e[3]=0,e[4]=t,e[5]=0,e[6]=0,e[7]=0,e[8]=t,e):new V(t,0,0,0,t,0,0,0,t)},V.fromCrossProduct=function(t,e){return h(e)?(e[0]=0,e[1]=t.z,e[2]=-t.y,e[3]=-t.z,e[4]=0,e[5]=t.x,e[6]=t.y,e[7]=-t.x,e[8]=0,e):new V(0,-t.z,t.y,t.z,0,-t.x,-t.y,t.x,0)},V.fromRotationX=function(t,e){const n=Math.cos(t),r=Math.sin(t);return h(e)?(e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=n,e[5]=r,e[6]=0,e[7]=-r,e[8]=n,e):new V(1,0,0,0,n,-r,0,r,n)},V.fromRotationY=function(t,e){const n=Math.cos(t),r=Math.sin(t);return h(e)?(e[0]=n,e[1]=0,e[2]=-r,e[3]=0,e[4]=1,e[5]=0,e[6]=r,e[7]=0,e[8]=n,e):new V(n,0,r,0,1,0,-r,0,n)},V.fromRotationZ=function(t,e){const n=Math.cos(t),r=Math.sin(t);return h(e)?(e[0]=n,e[1]=r,e[2]=0,e[3]=-r,e[4]=n,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e):new V(n,-r,0,r,n,0,0,0,1)},V.multiply=function(t,e,n){const r=t[0]*e[0]+t[3]*e[1]+t[6]*e[2],i=t[1]*e[0]+t[4]*e[1]+t[7]*e[2],o=t[2]*e[0]+t[5]*e[1]+t[8]*e[2],a=t[0]*e[3]+t[3]*e[4]+t[6]*e[5],s=t[1]*e[3]+t[4]*e[4]+t[7]*e[5],u=t[2]*e[3]+t[5]*e[4]+t[8]*e[5],c=t[0]*e[6]+t[3]*e[7]+t[6]*e[8],l=t[1]*e[6]+t[4]*e[7]+t[7]*e[8],f=t[2]*e[6]+t[5]*e[7]+t[8]*e[8];return n[0]=r,n[1]=i,n[2]=o,n[3]=a,n[4]=s,n[5]=u,n[6]=c,n[7]=l,n[8]=f,n},V.multiplyByPoint=function(t,e,n){const r=e.x,i=e.y,o=t[0]*r+t[3]*i+t[6],a=t[1]*r+t[4]*i+t[7];return n.x=o,n.y=a,n},V.multiplyByVector=function(t,e,n){const r=e.x,i=e.y,o=e.z,a=t[0]*r+t[3]*i+t[6]*o,s=t[1]*r+t[4]*i+t[7]*o,u=t[2]*r+t[5]*i+t[8]*o;return n.x=a,n.y=s,n.z=u,n},V.multiplyByScalar=function(t,e,n){return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n},V.determinant=function(t){const e=t[0],n=t[3],r=t[6],i=t[1],o=t[4],a=t[7],s=t[2],u=t[5],c=t[8];return e*(o*c-u*a)+i*(u*r-n*c)+s*(n*a-o*r)},V.inverse=function(t,e){const n=t[0],r=t[1],i=t[2],o=t[3],a=t[4],s=t[5],u=t[6],c=t[7],l=t[8],f=V.determinant(t);if(Math.abs(f)<=N.EPSILON15)throw new Error("matrix is not invertible");e[0]=a*l-c*s,e[1]=c*i-r*l,e[2]=r*s-a*i,e[3]=u*s-o*l,e[4]=n*l-u*i,e[5]=o*i-n*s,e[6]=o*c-u*a,e[7]=u*r-n*c,e[8]=n*a-o*r;const E=1/f;return V.multiplyByScalar(e,E,e)},V.transpose=function(t,e){const n=t[0],r=t[3],i=t[6],o=t[1],a=t[4],s=t[7],u=t[2],c=t[5],l=t[8];return e[0]=n,e[1]=r,e[2]=i,e[3]=o,e[4]=a,e[5]=s,e[6]=u,e[7]=c,e[8]=l,e},V.getColumn=function(t,e,n){const r=3*e,i=t[r],o=t[r+1],a=t[r+2];return n.x=i,n.y=o,n.z=a,n},V.setColumn=function(t,e,n,r){const i=3*e;return(r=V.clone(t,r))[i]=n.x,r[i+1]=n.y,r[i+2]=n.z,r},V.getRow=function(t,e,n){const r=t[e],i=t[e+3],o=t[e+6];return n.x=r,n.y=i,n.z=o,n},V.setRow=function(t,e,n,r){return(r=V.clone(t,r))[e]=n.x,r[e+3]=n.y,r[e+6]=n.z,r};const H=new O;V.setScale=function(t,e,n){const r=V.getScale(t,H),i=e.x/r.x,o=e.y/r.y,a=e.z/r.z;return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*o,n[4]=t[4]*o,n[5]=t[5]*o,n[6]=t[6]*a,n[7]=t[7]*a,n[8]=t[8]*a,n};const q=new O;V.setUniformScale=function(t,e,n){const r=V.getScale(t,q),i=e/r.x,o=e/r.y,a=e/r.z;return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3]*o,n[4]=t[4]*o,n[5]=t[5]*o,n[6]=t[6]*a,n[7]=t[7]*a,n[8]=t[8]*a,n};const $=new O;function Y(t,e,n,r,i,o,a,s,u,c,l,E,h,p,m,d){this[0]=f(t,0),this[1]=f(i,0),this[2]=f(u,0),this[3]=f(h,0),this[4]=f(e,0),this[5]=f(o,0),this[6]=f(c,0),this[7]=f(p,0),this[8]=f(n,0),this[9]=f(a,0),this[10]=f(l,0),this[11]=f(m,0),this[12]=f(r,0),this[13]=f(s,0),this[14]=f(E,0),this[15]=f(d,0)}V.getScale=function(t,e){return e.x=O.magnitude(O.fromElements(t[0],t[1],t[2],$)),e.y=O.magnitude(O.fromElements(t[3],t[4],t[5],$)),e.z=O.magnitude(O.fromElements(t[6],t[7],t[8],$)),e},V.IDENTITY=Object.freeze(new V(1,0,0,0,1,0,0,0,1)),V.prototype.toString=function(){return`(${this[0]}, ${this[3]}, ${this[6]})\n(${this[1]}, ${this[4]}, ${this[7]})\n(${this[2]}, ${this[5]}, ${this[8]})\n`},Object.defineProperties(Y.prototype,{length:{get:function(){return 16}}}),Y.clone=function(t,e){if(h(t))return h(e)?(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e):new Y(t[0],t[4],t[8],t[12],t[1],t[5],t[9],t[13],t[2],t[6],t[10],t[14],t[3],t[7],t[11],t[15])},Y.fromColumnMajorArray=function(t,e){return Y.clone(t,e)},Y.fromRowMajorArray=function(t,e){return h(e)?(e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15],e):new Y(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},Y.fromRotationTranslation=function(t,e,n){return e=f(e,O.ZERO),h(n)?(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=0,n[4]=t[3],n[5]=t[4],n[6]=t[5],n[7]=0,n[8]=t[6],n[9]=t[7],n[10]=t[8],n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,n):new Y(t[0],t[3],t[6],e.x,t[1],t[4],t[7],e.y,t[2],t[5],t[8],e.z,0,0,0,1)},Y.fromTranslationQuaternionRotationScale=function(t,e,n,r){h(r)||(r=new Y);const i=n.x,o=n.y,a=n.z,s=e.x*e.x,u=e.x*e.y,c=e.x*e.z,l=e.x*e.w,f=e.y*e.y,E=e.y*e.z,p=e.y*e.w,m=e.z*e.z,d=e.z*e.w,_=e.w*e.w,x=s-f-m+_,y=2*(u-d),T=2*(c+p),g=2*(u+d),A=-s+f-m+_,w=2*(E-l),R=2*(c-p),v=2*(E+l),b=-s-f+m+_;return r[0]=x*i,r[1]=g*i,r[2]=R*i,r[3]=0,r[4]=y*o,r[5]=A*o,r[6]=v*o,r[7]=0,r[8]=T*a,r[9]=w*a,r[10]=b*a,r[11]=0,r[12]=t.x,r[13]=t.y,r[14]=t.z,r[15]=1,r},Y.fromTranslationRotationScale=function(t,e){return Y.fromTranslationQuaternionRotationScale(t.translation,t.rotation,t.scale,e)},Y.fromTranslation=function(t,e){return Y.fromRotationTranslation(V.IDENTITY,t,e)},Y.fromScale=function(t,e){return h(e)?(e[0]=t.x,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t.y,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t.z,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e):new Y(t.x,0,0,0,0,t.y,0,0,0,0,t.z,0,0,0,0,1)},Y.fromUniformScale=function(t,e){return h(e)?(e[0]=t,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e):new Y(t,0,0,0,0,t,0,0,0,0,t,0,0,0,0,1)},Y.fromRotation=function(t,e){return h(e)||(e=new Y),e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=0,e[4]=t[3],e[5]=t[4],e[6]=t[5],e[7]=0,e[8]=t[6],e[9]=t[7],e[10]=t[8],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},Y.computePerspectiveFieldOfView=function(t,e,n,r,i){const o=1/Math.tan(.5*t),a=o/e,s=(r+n)/(n-r),u=2*r*n/(n-r);return i[0]=a,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=o,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=s,i[11]=-1,i[12]=0,i[13]=0,i[14]=u,i[15]=0,i},Y.computeView=function(t,e,n,r,i){return i[0]=r.x,i[1]=n.x,i[2]=-e.x,i[3]=0,i[4]=r.y,i[5]=n.y,i[6]=-e.y,i[7]=0,i[8]=r.z,i[9]=n.z,i[10]=-e.z,i[11]=0,i[12]=-O.dot(r,t),i[13]=-O.dot(n,t),i[14]=O.dot(e,t),i[15]=1,i},Y.getColumn=function(t,e,n){const r=4*e,i=t[r],o=t[r+1],a=t[r+2],s=t[r+3];return n.x=i,n.y=o,n.z=a,n.w=s,n},Y.setColumn=function(t,e,n,r){const i=4*e;return(r=Y.clone(t,r))[i]=n.x,r[i+1]=n.y,r[i+2]=n.z,r[i+3]=n.w,r},Y.getRow=function(t,e,n){const r=t[e],i=t[e+4],o=t[e+8],a=t[e+12];return n.x=r,n.y=i,n.z=o,n.w=a,n},Y.setRow=function(t,e,n,r){return(r=Y.clone(t,r))[e]=n.x,r[e+4]=n.y,r[e+8]=n.z,r[e+12]=n.w,r},Y.setTranslation=function(t,e,n){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=t[15],n};const W=new O;Y.setScale=function(t,e,n){const r=Y.getScale(t,W),i=e.x/r.x,o=e.y/r.y,a=e.z/r.z;return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3],n[4]=t[4]*o,n[5]=t[5]*o,n[6]=t[6]*o,n[7]=t[7],n[8]=t[8]*a,n[9]=t[9]*a,n[10]=t[10]*a,n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n};const j=new O;Y.setUniformScale=function(t,e,n){const r=Y.getScale(t,j),i=e/r.x,o=e/r.y,a=e/r.z;return n[0]=t[0]*i,n[1]=t[1]*i,n[2]=t[2]*i,n[3]=t[3],n[4]=t[4]*o,n[5]=t[5]*o,n[6]=t[6]*o,n[7]=t[7],n[8]=t[8]*a,n[9]=t[9]*a,n[10]=t[10]*a,n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n};const k=new O;Y.getScale=function(t,e){return e.x=O.magnitude(O.fromElements(t[0],t[1],t[2],k)),e.y=O.magnitude(O.fromElements(t[4],t[5],t[6],k)),e.z=O.magnitude(O.fromElements(t[8],t[9],t[10],k)),e};const Z=new O;Y.setRotation=function(t,e,n){const r=Y.getScale(t,Z);return n[0]=e[0]*r.x,n[1]=e[1]*r.x,n[2]=e[2]*r.x,n[3]=t[3],n[4]=e[3]*r.y,n[5]=e[4]*r.y,n[6]=e[5]*r.y,n[7]=t[7],n[8]=e[6]*r.z,n[9]=e[7]*r.z,n[10]=e[8]*r.z,n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n};const K=new O;Y.getRotation=function(t,e){const n=Y.getScale(t,K);return e[0]=t[0]/n.x,e[1]=t[1]/n.x,e[2]=t[2]/n.x,e[3]=t[4]/n.y,e[4]=t[5]/n.y,e[5]=t[6]/n.y,e[6]=t[8]/n.z,e[7]=t[9]/n.z,e[8]=t[10]/n.z,e},Y.multiply=function(t,e,n){const r=t[0],i=t[1],o=t[2],a=t[3],s=t[4],u=t[5],c=t[6],l=t[7],f=t[8],E=t[9],h=t[10],p=t[11],m=t[12],d=t[13],_=t[14],x=t[15],y=e[0],T=e[1],g=e[2],A=e[3],w=e[4],R=e[5],v=e[6],b=e[7],S=e[8],C=e[9],M=e[10],z=e[11],F=e[12],I=e[13],P=e[14],N=e[15],L=r*y+s*T+f*g+m*A,O=i*y+u*T+E*g+d*A,U=o*y+c*T+h*g+_*A,D=a*y+l*T+p*g+x*A,B=r*w+s*R+f*v+m*b,G=i*w+u*R+E*v+d*b,X=o*w+c*R+h*v+_*b,V=a*w+l*R+p*v+x*b,H=r*S+s*C+f*M+m*z,q=i*S+u*C+E*M+d*z,$=o*S+c*C+h*M+_*z,Y=a*S+l*C+p*M+x*z,W=r*F+s*I+f*P+m*N,j=i*F+u*I+E*P+d*N,k=o*F+c*I+h*P+_*N,Z=a*F+l*I+p*P+x*N;return n[0]=L,n[1]=O,n[2]=U,n[3]=D,n[4]=B,n[5]=G,n[6]=X,n[7]=V,n[8]=H,n[9]=q,n[10]=$,n[11]=Y,n[12]=W,n[13]=j,n[14]=k,n[15]=Z,n},Y.multiplyByMatrix3=function(t,e,n){const r=t[0],i=t[1],o=t[2],a=t[4],s=t[5],u=t[6],c=t[8],l=t[9],f=t[10],E=e[0],h=e[1],p=e[2],m=e[3],d=e[4],_=e[5],x=e[6],y=e[7],T=e[8],g=r*E+a*h+c*p,A=i*E+s*h+l*p,w=o*E+u*h+f*p,R=r*m+a*d+c*_,v=i*m+s*d+l*_,b=o*m+u*d+f*_,S=r*x+a*y+c*T,C=i*x+s*y+l*T,M=o*x+u*y+f*T;return n[0]=g,n[1]=A,n[2]=w,n[3]=0,n[4]=R,n[5]=v,n[6]=b,n[7]=0,n[8]=S,n[9]=C,n[10]=M,n[11]=0,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},Y.multiplyByVector=function(t,e,n){const r=e.x,i=e.y,o=e.z,a=e.w,s=t[0]*r+t[4]*i+t[8]*o+t[12]*a,u=t[1]*r+t[5]*i+t[9]*o+t[13]*a,c=t[2]*r+t[6]*i+t[10]*o+t[14]*a,l=t[3]*r+t[7]*i+t[11]*o+t[15]*a;return n.x=s,n.y=u,n.z=c,n.w=l,n},Y.multiplyByPointAsVector=function(t,e,n){const r=e.x,i=e.y,o=e.z,a=t[0]*r+t[4]*i+t[8]*o,s=t[1]*r+t[5]*i+t[9]*o,u=t[2]*r+t[6]*i+t[10]*o;return n.x=a,n.y=s,n.z=u,n},Y.multiplyByPoint=function(t,e,n){const r=e.x,i=e.y,o=e.z,a=t[0]*r+t[4]*i+t[8]*o+t[12],s=t[1]*r+t[5]*i+t[9]*o+t[13],u=t[2]*r+t[6]*i+t[10]*o+t[14];return n.x=a,n.y=s,n.z=u,n},Y.transpose=function(t,e){const n=t[1],r=t[2],i=t[3],o=t[6],a=t[7],s=t[11];return e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=n,e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=r,e[9]=o,e[10]=t[10],e[11]=t[14],e[12]=i,e[13]=a,e[14]=s,e[15]=t[15],e},Y.equals=function(t,e){return t===e||h(t)&&h(e)&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[3]===e[3]&&t[7]===e[7]&&t[11]===e[11]&&t[15]===e[15]},Y.equalsEpsilon=function(t,e,n){return n=f(n,0),t===e||h(t)&&h(e)&&Math.abs(t[0]-e[0])<=n&&Math.abs(t[1]-e[1])<=n&&Math.abs(t[2]-e[2])<=n&&Math.abs(t[3]-e[3])<=n&&Math.abs(t[4]-e[4])<=n&&Math.abs(t[5]-e[5])<=n&&Math.abs(t[6]-e[6])<=n&&Math.abs(t[7]-e[7])<=n&&Math.abs(t[8]-e[8])<=n&&Math.abs(t[9]-e[9])<=n&&Math.abs(t[10]-e[10])<=n&&Math.abs(t[11]-e[11])<=n&&Math.abs(t[12]-e[12])<=n&&Math.abs(t[13]-e[13])<=n&&Math.abs(t[14]-e[14])<=n&&Math.abs(t[15]-e[15])<=n},Y.getTranslation=function(t,e){return e.x=t[12],e.y=t[13],e.z=t[14],e},Y.getMatrix3=function(t,e){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e};const Q=new V,J=new V,tt=new G,et=new G(0,0,0,1);Y.inverse=function(t,e){const n=t[0],r=t[4],i=t[8],o=t[12],a=t[1],s=t[5],u=t[9],c=t[13],l=t[2],f=t[6],E=t[10],h=t[14],p=t[3],m=t[7],d=t[11],_=t[15];let x=E*_,y=h*d,T=f*_,g=h*m,A=f*d,w=E*m,R=l*_,v=h*p,b=l*d,S=E*p,C=l*m,M=f*p;const z=x*s+g*u+A*c-(y*s+T*u+w*c),F=y*a+R*u+S*c-(x*a+v*u+b*c),I=T*a+v*s+C*c-(g*a+R*s+M*c),P=w*a+b*s+M*u-(A*a+S*s+C*u),L=y*r+T*i+w*o-(x*r+g*i+A*o),O=x*n+v*i+b*o-(y*n+R*i+S*o),U=g*n+R*r+M*o-(T*n+v*r+C*o),D=A*n+S*r+C*i-(w*n+b*r+M*i);x=i*c,y=o*u,T=r*c,g=o*s,A=r*u,w=i*s,R=n*c,v=o*a,b=n*u,S=i*a,C=n*s,M=r*a;const B=x*m+g*d+A*_-(y*m+T*d+w*_),X=y*p+R*d+S*_-(x*p+v*d+b*_),H=T*p+v*m+C*_-(g*p+R*m+M*_),q=w*p+b*m+M*d-(A*p+S*m+C*d),$=T*E+w*h+y*f-(A*h+x*f+g*E),W=b*h+x*l+v*E-(R*E+S*h+y*l),j=R*f+M*h+g*l-(C*h+T*l+v*f),k=C*E+A*l+S*f-(b*f+M*E+w*l);let Z=n*z+r*F+i*I+o*P;if(Math.abs(Z)<N.EPSILON21){if(V.equalsEpsilon(Y.getMatrix3(t,Q),J,N.EPSILON7)&&G.equals(Y.getRow(t,3,tt),et))return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=0,e[11]=0,e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=1,e;throw new Error("matrix is not invertible because its determinate is zero.")}return Z=1/Z,e[0]=z*Z,e[1]=F*Z,e[2]=I*Z,e[3]=P*Z,e[4]=L*Z,e[5]=O*Z,e[6]=U*Z,e[7]=D*Z,e[8]=B*Z,e[9]=X*Z,e[10]=H*Z,e[11]=q*Z,e[12]=$*Z,e[13]=W*Z,e[14]=j*Z,e[15]=k*Z,e};const nt=new Y;function rt(t,e,n,r){this.x=f(t,0),this.y=f(e,0),this.z=f(n,0),this.w=f(r,0)}Y.inverseTranspose=function(t,e){return Y.inverse(Y.transpose(t,nt),e)},Y.IDENTITY=Object.freeze(new Y(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)),Y.ZERO=Object.freeze(new Y(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)),Y.prototype.clone=function(t){return Y.clone(this,t)},Y.prototype.equals=function(t){return Y.equals(this,t)},Y.prototype.equalsEpsilon=function(t,e){return Y.equalsEpsilon(this,t,e)},Y.prototype.toString=function(){return`(${this[0]}, ${this[4]}, ${this[8]}, ${this[12]})\n(${this[1]}, ${this[5]}, ${this[9]}, ${this[13]})\n(${this[2]}, ${this[6]}, ${this[10]}, ${this[14]})\n(${this[3]}, ${this[7]}, ${this[11]}, ${this[15]})`};const it=new O;rt.fromAxisAngle=function(t,e,n){const r=e/2,i=Math.sin(r);O.normalize(t,it);const o=it.x*i,a=it.y*i,s=it.z*i,u=Math.cos(r);return h(n)?(n.x=o,n.y=a,n.z=s,n.w=u,n):new rt(o,a,s,u)},rt.prototype.toString=function(){return`(${this.x}, ${this.y}, ${this.z}, ${this.w})`};const ot=t.p+"0515d79d591d9aaef1d1.png",at=function(){function t(){var t=this;this.transform=V.clone(V.IDENTITY),this.exposure=1,this.gamma=2.2,this.pointerPressed=!1,this.containerElem=document.createElement("div"),this.exposureValueElem=document.createElement("span"),this.exposureInputElem=document.createElement("input"),this.exposureInputElem.setAttribute("type","range"),this.exposureInputElem.setAttribute("min","0"),this.exposureInputElem.setAttribute("max","10"),this.exposureInputElem.setAttribute("value","1.0"),this.exposureInputElem.setAttribute("step","0.1"),this.exposureInputElem.addEventListener("input",(function(e){t.exposure=Number.parseFloat(t.exposureInputElem.value),t.exposureValueElem.innerText="Exposure(".concat(t.exposure.toFixed(1),"): "),t.rgbFloat&&t.width&&t.height&&t.render()})),this.exposureValueElem.innerText="Exposure(".concat(this.exposure.toFixed(1),"): "),this.containerElem.appendChild(this.exposureValueElem),this.containerElem.appendChild(this.exposureInputElem),this.gammaValueElem=document.createElement("span"),this.gammaInputElem=document.createElement("input"),this.gammaInputElem.setAttribute("type","range"),this.gammaInputElem.setAttribute("min","0"),this.gammaInputElem.setAttribute("max","3"),this.gammaInputElem.setAttribute("value","2.2"),this.gammaInputElem.setAttribute("step","0.1"),this.gammaInputElem.addEventListener("input",(function(e){t.gamma=Number.parseFloat(t.gammaInputElem.value),t.gammaValueElem.innerText="Gamma(".concat(t.gamma.toFixed(1),"): "),t.rgbFloat&&t.width&&t.height&&t.render()})),this.gammaValueElem.innerText="Gamma(".concat(this.gamma.toFixed(1),"): "),this.containerElem.appendChild(document.createElement("br")),this.containerElem.appendChild(this.gammaValueElem),this.containerElem.appendChild(this.gammaInputElem),this.pixelDataElem=document.createElement("div"),this.pixelDataElem.innerHTML="&nbsp;",this.containerElem.appendChild(this.pixelDataElem),this.gl=function(t){let e,n=(t=f(t,f.EMPTY_OBJECT)).canvas;if(n||(n=E.document.createElement("canvas"),n.style.width="100vw",n.style.height="100vh",n.style.setProperty("display","block"),n.width=window.innerWidth,n.height=window.innerHeight),e=t.requireWebgl2?n.getContext("webgl2",t):n.getContext("webgl",t),!e.createVertexArray){const t=e.getExtension("OES_vertex_array_object");t&&(e.createVertexArray=t.createVertexArrayOES.bind(t),e.bindVertexArray=t.bindVertexArrayOES.bind(t),e.deleteVertexArray=t.deleteVertexArrayOES.bind(t),e.isVertexArray=t.isVertexArrayOES.bind(t),e.VERTEX_ARRAY_BINDING=t.VERTEX_ARRAY_BINDING_OES)}if(!e.drawArraysInstanced){const t=e.getExtension("ANGLE_instanced_arrays");t&&(e.drawArraysInstanced=t.drawArraysInstancedANGLE.bind(t),e.drawElementsInstanced=t.drawElementsInstancedANGLE.bind(t),e.vertexAttribDivisor=t.vertexAttribDivisorANGLE.bind(t),e.VERTEX_ATTRIB_ARRAY_DIVISOR=t.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)}if(!e.drawBuffers){const t=e.getExtension("WEBGL_draw_buffers");if(t){e.drawBuffers=t.drawBuffersWEBGL.bind(t);for(let n=1;n<=15;n++)e[`COLOR_ATTACHMENT${n}`]=t[`COLOR_ATTACHMENT${n}_WEBGL`],e[`DRAW_BUFFER${n}`]=t[`DRAW_BUFFER${n}_WEBGL`];e.MAX_COLOR_ATTACHMENTS=t.MAX_COLOR_ATTACHMENTS_WEBGL,e.MAX_DRAW_BUFFERS=t.MAX_DRAW_BUFFERS_WEBGL,e.MAX_DRAW_BUFFERS=t.MAX_DRAW_BUFFERS_WEBGL}}if(!e.MAX_TEXTURE_MAX_ANISOTROPY){const t=e.getExtension("EXT_texture_filter_anisotropic");t&&(e.MAX_TEXTURE_MAX_ANISOTROPY=t.MAX_TEXTURE_MAX_ANISOTROPY_EXT,e.TEXTURE_MAX_ANISOTROPY=t.TEXTURE_MAX_ANISOTROPY_EXT)}if(!e.MIN){const t=e.getExtension("EXT_blend_minmax");t&&(e.MIN=t.MIN_EXT,e.MAX=t.MAX_EXT)}if(!e.FRAGMENT_SHADER_DERIVATIVE_HINT){const t=e.getExtension("OES_standard_derivatives");t&&(e.FRAGMENT_SHADER_DERIVATIVE_HINT=t.FRAGMENT_SHADER_DERIVATIVE_HINT_OES)}if(!e.UNSIGNED_INT_24_8){const t=e.getExtension("WEBGL_depth_texture");t&&(e.UNSIGNED_INT_24_8=t.UNSIGNED_INT_24_8_WEBGL)}if(!e.HALF_FLOAT){const t=e.getExtension("OES_texture_half_float");t&&(e.HALF_FLOAT=t.HALF_FLOAT_OES)}if(!e.RGBA32F){const t=e.getExtension("WEBGL_color_buffer_float");t&&(e.RGBA32F=t.RGBA32F_EXT,e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=t.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT,e.UNSIGNED_NORMALIZED=t.UNSIGNED_NORMALIZED_EXT,e._colorBufferFloat=!!t)}return e.extS3tc=e.getExtension("WEBGL_compressed_texture_s3tc"),e.extPvrtc=e.getExtension("WEBGL_compressed_texture_pvrtc"),e.extAstc=e.getExtension("WEBGL_compressed_texture_astc"),e.extEtc=e.getExtension("WEBG_compressed_texture_etc"),e.extEtc1=e.getExtension("WEBG_compressed_texture_etc1"),e.extBc7=e.getExtension("EXT_texture_compression_bptc"),e.extDebugShaders=e.getExtension("WEBGL_debug_shaders"),e._elementIndexUint=!!e.getExtension("OES_element_index_uint"),e._fragDepth=!!e.getExtension("EXT_frag_depth"),e._textureFloat=!!e.getExtension("OES_texture_float"),e._textureFloatLinear=!!e.getExtension("OES_texture_float_linear"),e._colorBufferFloat=e._colorBufferFloat||!!e.getExtension("EXT_color_buffer_float"),e._colorBufferHalfFloat=!!e.getExtension("EXT_color_buffer_half_float"),e._floatBlend=!!e.getExtension("EXT_float_blend"),e._shaderTextureLod=!!e.getExtension("EXT_shader_texture_lod"),e}(),this.vao=S(this.gl,{attributes:{aPosition:{location:0,size:2,data:[-1,-1,3,-1,-1,3]}}}),this.readyPromise=new Promise((function(e){var n=new Image;n.src=ot,n.onload=function(){t.miniFontTexture=g(t.gl,{format:t.gl.RGBA,type:t.gl.UNSIGNED_BYTE,internalFormat:t.gl.RGBA,data:n,wrapS:t.gl.CLAMP_TO_EDGE,wrapT:t.gl.CLAMP_TO_EDGE,minFilter:t.gl.NEAREST,magFilter:t.gl.NEAREST,flipY:!1}),e()}})),this.canvas=this.gl.canvas,this.canvas.width=1200,this.canvas.height=650,this.canvas.style.border="1px solid black",this.canvas.style.width=this.canvas.width+"px",this.canvas.style.height=this.canvas.height+"px",window.addEventListener("dragover",(function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"})),window.addEventListener("drop",(function(e){e.stopPropagation(),e.preventDefault();var n,r=e.dataTransfer;r.items&&r.items.length>0?n=r.items[0].getAsFile():r.files&&r.files.length>0&&(n=r.files[0]),n&&t.readFile(n).then((function(){t.render()}))})),this.canvas.addEventListener("contextmenu",(function(t){t.preventDefault()})),this.canvas.addEventListener("pointermove",(function(e){if(t.pointerPressed&&e.movementX&&e.movementY){var n=-e.movementX/t.canvas.width,r=-e.movementY/t.canvas.height,i=V.getScale(t.transform,new O);t.transform[6]+=n*i.x*(t.canvas.width/t.width),t.transform[7]+=r*i.y*(t.canvas.height/t.height),t.render()}})),this.canvas.addEventListener("pointerdown",(function(e){if(t.rgbFloat&&(t.pointerPressed=!0,2===e.button)){var n=t.canvas.getBoundingClientRect(),r=(e.clientX-n.left)*t.transform[0],i=(e.clientY-n.top)*t.transform[4];if(r+=t.transform[6]*t.width,i+=t.transform[7]*t.height,r=Math.floor(r),i=Math.floor(i),!(r<0||r>=t.width||i<0||i>=t.height)){var o=i*t.width+r,a=[t.rgbFloat[3*o+0],t.rgbFloat[3*o+1],t.rgbFloat[3*o+2]];t.pixelDataElem.innerText="(".concat(r,", ").concat(i,") = (").concat(a.join(", "),")")}}})),this.canvas.addEventListener("pointerup",(function(){t.pointerPressed=!1})),this.canvas.addEventListener("wheel",(function(e){e.preventDefault();var n=t.canvas.getBoundingClientRect(),r=new L((Math.floor(e.clientX)-n.left)/n.width,(Math.floor(e.clientY)-n.top)/n.height),i=1+.05*Math.sign(e.deltaY),o=V.getScale(t.transform,new O),a=new L(t.width/t.canvas.width,t.height/t.canvas.height),s=2/Math.min(t.canvas.width,t.canvas.height);if(!((o.x>5*a.x||o.y>5*a.x)&&i>1||(o.x<s||o.y<s)&&i<1)){var u=t.transform,c=r.clone();c.x/=a.x,c.y/=a.y;var l=V.multiplyByPoint(u,c,new L),f=V.multiply(new V(i,0,0,0,i,0,0,0,1),u,new V),E=V.multiplyByPoint(f,c,new L);V.multiply(new V(1,0,l.x-E.x,0,1,l.y-E.y,0,0,1),f,f),V.clone(f,t.transform),t.render()}})),this.containerElem.appendChild(this.canvas),document.body.appendChild(this.containerElem)}return t.prototype.readFile=function(t){var e,n,r=this,i=new Promise((function(t,r){e=t,n=r})),o=new FileReader;return o.readAsArrayBuffer(new Blob([t])),o.onload=function(){if(o.readyState===FileReader.DONE){var t=o.result;e(r.readBuffer(new Uint8Array(t)))}},o.onerror=function(t){n(t)},i},t.prototype.readBuffer=function(t){var e=l.read(new Uint8Array(t));if("string"==typeof e)return alert(e),this;var n=this.gl;this.rgbFloat=e.rgbFloat,this.width=e.width,this.height=e.height;var r=Math.max(this.height/this.canvas.height,this.width/this.canvas.width);return this.transform=V.fromScale(new O(r,r,1)),this.texture&&(this.gl.deleteTexture(this.texture),this.texture=void 0),this.texture=g(n,{width:this.width,height:this.height,data:this.rgbFloat,format:n.RGB,type:n.FLOAT,internalFormat:n.RGB,wrapS:n.CLAMP_TO_EDGE,wrapT:n.CLAMP_TO_EDGE,minFilter:n.NEAREST,magFilter:n.NEAREST}),this},t.prototype.render=function(){var t=this.gl,e=this.width,n=this.height,r=this.texture,i=this.exposure;if(e&&n&&this.miniFontTexture){var o=[0,0,t.drawingBufferWidth,t.drawingBufferHeight];!function(t,e){const{depthTest:n,stencilTest:r,colorMask:i,cull:o,blend:a,viewport:s,scissor:u,polygonOffset:c,sampleCoverage:l,dither:f}=e;if(o){o.enable?t.enable(t.CULL_FACE):t.disable(t.CULL_FACE);const e=o.face&&o.face.toUpperCase();"BACK"!==e&&"FRONT"!==e&&"FRONT_AND_BACK"!==e||t.cullFace(t[e]);let n=h(o.frontFace)&&o.frontFace.toUpperCase();"CCW"!==n&&"CW"!==n||t.frontFace(t[n])}if(n){if(!0===n.enable?t.enable(t.DEPTH_TEST):!1===n.enable&&t.disable(t.DEPTH_TEST),n.func){const e=n.func.toUpperCase();t.depthFunc(t[e])}!0===n.write?t.depthMask(!0):!1===n.write&&t.depthMask(!1)}if(r){!0===r.enable?t.enable(t.STENCIL_TEST):!1===r.enable&&t.disable(t.STENCIL_TEST);const{front:e,back:n}=r;e&&d(t,t.FRONT,e),n&&d(t,t.BACK,n)}if(i&&t.colorMask(i[0],i[1],i[2],i[3]),a){if(!0===a.enable?t.enable(t.BLEND):!1===a.enable&&t.disable(t.BLEND),a.blendColor&&t.blendColor(...a.blendColor),a.blendEquationSeparate){const{rgb:e,alpha:n}=a.blendEquationSeparate;if(!h(e)||!h(n))throw new Error("To use blendEquationSeparate you MUST specify rgb and alpha.");const r=e.toUpperCase(),i=n.toUpperCase(),o=t[r],s=t[i];if(!h(o))throw new Error("gl."+r+" is undefined.");if(!h(s))throw new Error("gl."+i+" is undefined.");t.blendEquationSeparate(o,s)}else if(a.blendEquation){const e=a.blendEquation.toUpperCase(),n=t[e];if(!h(n))throw new Error(e+" is invalid.");t.blendEquation(n)}const e=a.blendFuncSeparate;if(h(e)){const{srcRGB:n,dstRGB:r,srcAlpha:i,dstAlpha:o}=e;if(!h(n))throw new Error("To use blendFuncSeparate you MUST specify srcRGB property.");if(!h(r))throw new Error("To use blendFuncSeparate you MUST specify dstRGB property.");if(!h(i))throw new Error("To use blendFuncSeparate you MUST specify srcAlpha property.");if(!h(o))throw new Error("To use blendFuncSeparate you MUST specify dstAlpha property.");const a=n.toUpperCase(),s=r.toUpperCase(),u=i.toUpperCase(),c=o.toUpperCase(),l=m(t,a),f=m(t,s),E=m(t,u),p=m(t,c);t.blendFuncSeparate(l,f,E,p)}else if(h(a.blendFunc)){const e=a.blendFunc[0].toUpperCase(),n=a.blendFunc[1].toUpperCase(),r=m(t,e),i=m(t,n);t.blendFunc(r,i)}}if(s&&t.viewport(s[0],s[1],s[2],s[3]),u){!0===u.enable?t.enable(t.SCISSOR_TEST):!1===u.enable&&t.disable(t.SCISSOR_TEST);const e=u.rect;e&&t.scissor(e[0],e[1],e[2],e[3])}if(h(c)&&(!0===c.enable?t.enable(t.POLYGON_OFFSET_FILL):!1===c.enable?t.disable(t.POLYGON_OFFSET_FILL):console.warn("polygonOffset.enable MUST be either true or false, current is "+c.enable.toString()+"."),t.polygonOffset(c.factor,c.units)),h(l)){const{alphaToCoverage:e,value:n,invert:r,enable:i}=l;!0===e?t.enable(t.SAMPLE_ALPHA_TO_COVERAGE):!1===e&&t.disable(t.SAMPLE_ALPHA_TO_COVERAGE),!0===i?t.enable(t.SAMPLE_COVERAGE):!1===i&&t.disable(t.SAMPLE_COVERAGE),h(n)&&h(r)&&(!0!==r&&!1!==r&&console.warn("sampleCoverage.invert MUST be boolean."),t.sampleCoverage(n,r))}h(f)&&(!0===f?t.enable(t.DITHER):!1===f?t.disable(t.DITHER):console.warn("setState: dither MUST be a boolean value, otherwise it will be ignored."))}(t,{viewport:o}),function(t,e){const{attributes:n,indices:r,vao:i,vs:o,fs:a,attributeLocations:s,fb:u}=e;let c=e.count;if(!h(c)&&h(r)&&(c=r.length),!h(c))throw new Error("vertices count or indices is not defined.");if(h(i)&&!h(s))throw new Error("To use vao, you must defined attributeLocations.");const l=f(e.primitiveType,t.TRIANGLES),E=f(e.uniforms,f.EMPTY_OBJECT),p=f(e.instanceCount,0);t.bindFramebuffer(t.FRAMEBUFFER,u);const m=o+a;let d=C[m];d||(d=function(t,e,n,r){const i=t.createShader(t.VERTEX_SHADER);t.shaderSource(i,e),t.compileShader(i);const o=t.createShader(t.FRAGMENT_SHADER);t.shaderSource(o,n),t.compileShader(o);const a=t.createProgram();if(t.attachShader(a,i),t.attachShader(a,o),t.deleteShader(i),t.deleteShader(o),h(r))for(const e in r)if(Object.hasOwnProperty.call(r,e)){const n=r[e];t.bindAttribLocation(a,n,e)}t.linkProgram(a);let s="";return t.getProgramParameter(a,t.LINK_STATUS)||(t.getShaderParameter(o,t.COMPILE_STATUS)||(s=t.getShaderInfoLog(o),console.error("Fragment shader failed to compiled: "+s)),t.getShaderParameter(i,t.COMPILE_STATUS)||(s=t.getShaderInfoLog(i),console.error("Vertex shader failed to compiled: "+s)),s=t.getProgramInfoLog(a),console.error("Shader program link log: "+s)),a}(t,o,a,s),C[m]=d),t.useProgram(d);const _=t.getProgramParameter(d,t.ACTIVE_ATTRIBUTES);if(h(i))t.bindVertexArray(i);else{if(!h(n))throw new Error("vao or attributes must be defined.");{const e=function(t,e){let n="";for(const e in t)Object.hasOwnProperty.call(t,e)&&(n+=t[e].toString());return e&&(n+=e.toString()),n}(n,r);let i=I[e];if(!i){const o={};for(let e=0;e<_;e++){const r=t.getActiveAttrib(d,e),i=r.name;if(Object.hasOwnProperty.call(n,i)){const e=n[i],a=t.getAttribLocation(d,i);if(-1===a)continue;const s=F(r);o[i]={location:a,size:s,data:e}}}i=S(t,{attributes:o,indices:r}),I[e]=i}t.bindVertexArray(i)}}const x=t.getProgramParameter(d,t.ACTIVE_UNIFORMS),y=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);let T=0;for(let e=0;e<x;e++){const n=t.getActiveUniform(d,e);let r=n.name;const i=n.type;let o=!1;const a=r.indexOf("[");if(a>=0&&(r=r.slice(0,a),o=!0),Object.hasOwnProperty.call(E,r)){let e=E[r];e="function"==typeof e?e():e;const a=t.getUniformLocation(d,r);if(null===a)continue;if(o){const n=z(i);t["uniform"+n+"fv"](a,Array.from(e));continue}const s=typeof e,u=t.TEXTURE0+T;if(e instanceof WebGLTexture){if(t.activeTexture(u),n.type===t.SAMPLER_2D)t.bindTexture(t.TEXTURE_2D,e);else if(n.type===t.SAMPLER_3D)t.bindTexture(t.TEXTURE_3D,e);else{if(n.type!==t.SAMPLER_CUBE)throw new Error(n,"type MUST be SAMPLER_2D or SAMPLER_CUBE");t.bindTexture(t.TEXTURE_CUBE_MAP,e)}t.uniform1i(a,T),T++}else if(i===t.FLOAT_MAT4)t.uniformMatrix4fv(a,!1,Array.from(e));else if(i===t.FLOAT_MAT3)t.uniformMatrix3fv(a,!1,Array.from(e));else if(i===t.FLOAT_MAT2)t.uniformMatrix2fv(a,!1,Array.from(e));else if(i===t.FLOAT_VEC4)t.uniform4fv(a,Array.from(e));else if(i===t.FLOAT_VEC3)t.uniform3fv(a,Array.from(e));else if(i===t.FLOAT_VEC2)t.uniform2fv(a,Array.from(e));else if(i===t.FLOAT)t.uniform1f(a,e);else if(i===t.BOOL||i===t.INT)t.uniform1i(a,e);else if("string"===s){if(T>y){console.error("texture exceed maximum texture units.");continue}let n=M[e];if(!n){n=t.createTexture(),t.activeTexture(u),t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array([255,255,255,255]));const r=new Image;r.src=e,r.addEventListener("load",(()=>{t.activeTexture(u),t.bindTexture(t.TEXTURE_2D,n),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r)})),M[e]=n}t.activeTexture(u),t.bindTexture(t.TEXTURE_2D,n),t.uniform1i(a,T),T++}else console.warn(`Unknown uniform ${r}, type: ${e}.`)}else console.warn(`Uniforms haven't ${r} property.`)}const g=t.getParameter(t.ELEMENT_ARRAY_BUFFER_BINDING);if(r&&r.length>0){const e=b(t,r,t.STATIC_DRAW);t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,e);const n=w(r);0===p?t.drawElements(l,c,n,0):t.drawElementsInstanced(l,c,n,0,p)}else if(g){const e=g.indicesType;0===p?t.drawElements(l,c,e,0):t.drawElementsInstanced(l,c,e,0,p)}else 0===p?t.drawArrays(l,0,c):t.drawArraysInstanced(l,0,c,p)}(t,{vs:"attribute vec2 aPosition;\r\nvarying vec2 vUv;\r\nvoid main() {\r\n  gl_Position = vec4(aPosition, 0, 1);\r\n  vUv = (gl_Position.xy / gl_Position.w);\r\n  vUv = vUv * 0.5 + 0.5;\r\n}",fs:"precision highp float;\r\nconst int NATIVE_CHARACTER_RES = 8;\r\n\r\nconst int _0_ = 48;\r\nconst int _1_ = 49;\r\nconst int _2_ = 50;\r\nconst int _3_ = 51;\r\nconst int _4_ = 52;\r\nconst int _5_ = 53;\r\nconst int _6_ = 54;\r\nconst int _7_ = 55;\r\nconst int _8_ = 56;\r\nconst int _9_ = 57;\r\nconst int _A_ = 65;\r\nconst int _B_ = 66;\r\nconst int _C_ = 67;\r\nconst int _D_ = 68;\r\nconst int _E_ = 69;\r\nconst int _F_ = 70;\r\nconst int _G_ = 71;\r\nconst int _H_ = 72;\r\nconst int _I_ = 73;\r\nconst int _J_ = 74;\r\nconst int _K_ = 75;\r\nconst int _L_ = 76;\r\nconst int _M_ = 77;\r\nconst int _N_ = 78;\r\nconst int _O_ = 79;\r\nconst int _P_ = 80;\r\nconst int _Q_ = 81;\r\nconst int _R_ = 82;\r\nconst int _S_ = 83;\r\nconst int _T_ = 84;\r\nconst int _U_ = 85;\r\nconst int _V_ = 86;\r\nconst int _W_ = 87;\r\nconst int _X_ = 88;\r\nconst int _Y_ = 89;\r\nconst int _Z_ = 90;\r\nconst int _MINUS_ = 45;\r\nconst int _COMMA_ = 44;\r\nconst int _DOT_ = 46;\r\nconst int _PLUS_ = 43;\r\nconst int _SPC_ = 32;\r\nconst int _QUESTIONMARK_ = 63;\r\n\r\nuniform sampler2D uMiniFontTexture;\r\n\r\nint clamp(int value, int minValue, int maxValue) {\r\n  return value < minValue\r\n    ? minValue\r\n    : value > maxValue\r\n      ? maxValue\r\n      : value;\r\n}\r\n\r\nfloat SampleMiniFont(int InAsciiCode, ivec2 Position) {\r\n  // Limit ASCII character to the Standard character set (32 - 127)\r\n  int TextureCode = clamp(InAsciiCode, 32, 127) - 32;\r\n  return texture2D(\r\n    uMiniFontTexture,\r\n    (vec2(TextureCode * NATIVE_CHARACTER_RES + Position.x, Position.y) + vec2(0.5)) / vec2(NATIVE_CHARACTER_RES * (127-32+1), NATIVE_CHARACTER_RES),\r\n    -1000.0\r\n  ).r;\r\n}\r\n\r\n\r\nvoid PrintCharacter(\r\n  ivec2 PixelPos,\r\n  inout vec3 OutColor,\r\n  vec3 FontColor,\r\n  inout ivec2 LeftTop,\r\n  int CharacterID\r\n) {\r\n  ivec2 Rel = (PixelPos - LeftTop);\r\n\r\n  if (Rel.x >= 0 && Rel.x < NATIVE_CHARACTER_RES &&\r\n    Rel.y >= 0 && Rel.y < NATIVE_CHARACTER_RES) {\r\n    OutColor.rgb = mix(OutColor.rgb, FontColor, SampleMiniFont(CharacterID, Rel));\r\n  }\r\n\r\n  LeftTop.x += NATIVE_CHARACTER_RES;\r\n}\r\n\r\nint ExtractDigitFromFloat(float Number, float DigitValue) {\r\n  float Temp = floor(Number / DigitValue);\r\n  return int(mod(Temp, 10.)) + _0_;\r\n}\r\n\r\nvarying vec2 vUv;\r\nuniform sampler2D uTexture;\r\nuniform float uExposure;\r\nuniform float uGamma;\r\nuniform vec2 uSize;\r\nuniform vec4 uViewport;\r\nuniform mat3 uTransform;\r\n\r\nvoid PrintHDRFloat(\r\n  ivec2 PixelPos,\r\n  inout vec3 OutColor,\r\n  vec3 FontColor,\r\n  ivec2 LeftTop,\r\n  float Number\r\n) {\r\n  ivec2 Cursor = LeftTop;\r\n  int Digit;\r\n\r\n  for (float i = 10.0; i > 0.0; i--) {\r\n    Digit = ExtractDigitFromFloat(Number, pow(10.0, i));\r\n    if (Digit != _0_) {\r\n      PrintCharacter(PixelPos, OutColor, FontColor, Cursor, Digit);\r\n    }\r\n  }\r\n\r\n  Digit = ExtractDigitFromFloat(Number, 1.0);\r\n  PrintCharacter(PixelPos, OutColor, FontColor, Cursor, Digit);\r\n\r\n  PrintCharacter(PixelPos, OutColor, FontColor, Cursor, _DOT_);\r\n\r\n  Digit = ExtractDigitFromFloat(Number, 0.1);\r\n  PrintCharacter(PixelPos, OutColor, FontColor, Cursor, Digit);\r\n  Digit = ExtractDigitFromFloat(Number, 0.01);\r\n  PrintCharacter(PixelPos, OutColor, FontColor, Cursor, Digit);\r\n  Digit = ExtractDigitFromFloat(Number, 0.001);\r\n  PrintCharacter(PixelPos, OutColor, FontColor, Cursor, Digit);\r\n  Digit = ExtractDigitFromFloat(Number, 0.0001);\r\n  PrintCharacter(PixelPos, OutColor, FontColor, Cursor, Digit);\r\n}\r\n\r\nfloat checker(vec2 uv, float repeats) {\r\n  float cx = floor(repeats * uv.x);\r\n  float cy = floor(repeats * uv.y);\r\n  float result = mod(cx + cy, 2.0);\r\n  return result > 0.0 ?\r\n    204./255. :\r\n    1.0;\r\n}\r\n\r\nvoid main() {\r\n  vec2 uv = vec2(vUv.x, 1.0 - vUv.y);\r\n  uv *= uViewport.zw / uSize;\r\n  uv = (uTransform * vec3(uv, 1)).xy;\r\n\r\n  vec3 hdrData = texture2D(uTexture, uv).rgb;\r\n  gl_FragColor.rgb = hdrData.rgb;\r\n  gl_FragColor.a = 1.0;\r\n\r\n  gl_FragColor.rgb *= uExposure;\r\n  gl_FragColor.rgb = pow(gl_FragColor.rgb, vec3(1./uGamma));\r\n\r\n  vec2 scale = vec2(uTransform[0][0], uTransform[1][1]);\r\n\r\n  vec2 texelSize = vec2(1) / uSize * scale;\r\n  vec2 gap = texelSize * 3.0;\r\n  if (uv.x < 0.0 || uv.x > 1.0 || uv.y < 0.0 || uv.y > 1.0) {\r\n    float repeats = 50.0;\r\n    gl_FragColor.rgb = vec3(checker(vec2(uv.x * (uSize.x/uSize.y), uv.y), repeats));\r\n    return;\r\n  }\r\n\r\n  gl_FragColor.a = 1.0;\r\n\r\n  float minScale = 4.0 / min(uViewport.z, uViewport.w);\r\n  if (uTransform[0][0] < (minScale * 2.0)) {\r\n    vec2 fontUV = fract(uv*uSize) * float(NATIVE_CHARACTER_RES);\r\n\r\n    ivec2 pixelPosLocal = ivec2(fontUV * 10.);\r\n\r\n    ivec2 leftTop = ivec2(NATIVE_CHARACTER_RES, NATIVE_CHARACTER_RES * 2);\r\n    vec3 fontColor = vec3(0.8, 0, 0);\r\n    PrintHDRFloat(\r\n      pixelPosLocal,\r\n      gl_FragColor.rgb,\r\n      vec3(0),\r\n      ivec2(leftTop.x, leftTop.y+1),\r\n      hdrData.r\r\n    );\r\n    PrintHDRFloat(\r\n      pixelPosLocal,\r\n      gl_FragColor.rgb,\r\n      fontColor,\r\n      leftTop,\r\n      hdrData.r\r\n    );\r\n\r\n    leftTop.y += NATIVE_CHARACTER_RES * 2;\r\n    fontColor = vec3(0, 0.8, 0);\r\n    PrintHDRFloat(\r\n      pixelPosLocal,\r\n      gl_FragColor.rgb,\r\n      vec3(0),\r\n      ivec2(leftTop.x, leftTop.y+1),\r\n      hdrData.g\r\n    );\r\n    PrintHDRFloat(\r\n      pixelPosLocal,\r\n      gl_FragColor.rgb,\r\n      fontColor,\r\n      leftTop,\r\n      hdrData.g\r\n    );\r\n\r\n    leftTop.y += NATIVE_CHARACTER_RES * 2;\r\n    fontColor = vec3(0, 0, 0.8);\r\n    PrintHDRFloat(\r\n      pixelPosLocal,\r\n      gl_FragColor.rgb,\r\n      vec3(0),\r\n      ivec2(leftTop.x, leftTop.y+1),\r\n      hdrData.b\r\n    );\r\n    PrintHDRFloat(\r\n      pixelPosLocal,\r\n      gl_FragColor.rgb,\r\n      fontColor,\r\n      leftTop,\r\n      hdrData.b\r\n    );\r\n  }\r\n}",attributeLocations:{aPosition:0},vao:this.vao,uniforms:{uTexture:r,uExposure:i,uSize:[this.width,this.height],uViewport:o,uTransform:this.transform,uGamma:this.gamma,uMiniFontTexture:this.miniFontTexture},count:3})}},t}(),st=t.p+"5e9e52476739dc6d1e25.hdr";var ut=new at;Promise.all([fetch(st).then((function(t){return t.arrayBuffer()})),ut.readyPromise]).then((function(t){var e=t[0];ut.readBuffer(new Uint8Array(e)).render()}));var ct=document.createElement("input");ct.setAttribute("accept",".hdr"),ct.setAttribute("type","file"),ct.addEventListener("input",(function(t){var e=ct.files&&ct.files[0];e&&ut.readFile(e).then((function(){ut.render()})).catch((function(t){alert(t)}))})),document.body.appendChild(ct)})();